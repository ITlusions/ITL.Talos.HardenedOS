# Build Pipeline - Visual Overview

## What Happens When You Create a Tag

```
You: git tag v1.0.0 && git push origin v1.0.0
                  ↓
            GitHub Actions Triggered
                  ↓
    ┌─────────────┬─────────────┬──────────────┐
    ↓             ↓             ↓              ↓
Build         Build          Build         Generate
Branding      Extensions     Installer     Configs
(5 min)       (10 min)       (5 min)       (5 min)
    └─────────────┬─────────────┬──────────────┘
                  ↓
               Build ISO
              (15 min)
                  ↓
          Create Release
            (2 min)
                  ↓
        Release Published
```

## Files Transformed

YOUR EDITS                     GENERATED BY PIPELINE

config/patches/
  - branding-patch.yaml  ───→  config/output/
  - security-hardening.yaml    - controlplane-final.yaml
                               - worker-final.yaml

extensions/
  - itl-branding/        ───→  ghcr.io/itlusions/
  - itl-security/            - itl-talos-branding:v1.0.0
                             - itl-talos-security:v1.0.0

build/
  - Dockerfile.installer ───→  ghcr.io/itlusions/
  - scripts/                 - itl-talos-installer:v1.0.0

branding/                  GitHub Release v1.0.0
  - templates/      ───→   itl-talos-v1.9.0.iso
                           controlplane-final.yaml
                           worker-final.yaml

## What You Download

GitHub Release v1.0.0
├── itl-talos-v1.9.0.iso          BOOT THIS (500 MB)
├── itl-talos-v1.9.0.iso.sha256   VERIFY THIS (1 KB)
├── controlplane-final.yaml        DEPLOY THIS (10 KB)
├── worker-final.yaml              DEPLOY THIS (10 KB)
└── Release Notes                  READ THIS (2 KB)
    - Features
    - Installation methods
    - Upgrade guide
    - Support info

## Deployment Paths

Download ISO                  Download YAML Configs
    ↓                               ↓
Write to USB         talosctl apply-config
    ↓
Boot Machine
    ↓
Follow Talos Prompts
    ↓
    Deployed

## Time Breakdown

Build Time Chart
├─ build-branding        5 min   ##
├─ build-extensions     10 min   ####
├─ build-installer       5 min   ##
├─ generate-configs      5 min   ##
├─ build-iso            15 min   ######  (Longest)
└─ create-release        2 min   #
        Total           45 min

With Cache (next time)
├─ build-branding        2 min
├─ build-extensions      3 min
├─ build-installer       2 min
├─ generate-configs      3 min
├─ build-iso            10 min
└─ create-release        2 min
        Total           22 min

## Customization Flow

You Edit                Pipeline Does            Result

branding-patch.yaml  ─→ Applies patches      ─→ Custom
                        to Talos configs       console
                                               banner

security-hardening   ─→ Adds TPM, LUKS2,   ─→ Encrypted
.yaml                   kernel hardening       nodes

extensions/          ─→ Builds Docker       ─→ Custom
Dockerfile              images                 features

workflow file        ─→ Changes Talos       ─→ Newer
                        version                kernel

## Status Flow

┌────────────────────┐
│  TAG CREATED       │
│  v1.0.0            │
└────────┬───────────┘
         ↓
┌────────────────────┐
│  BUILDING          │
│  [████████░░░░░░]  │
│  build-branding    │
│  build-extensions  │
│  build-installer   │
│  generate-configs  │
│  build-iso (15min) │
│  create-release    │
└────────┬───────────┘
         ↓
┌────────────────────┐
│  COMPLETE          │
│                    │
│ Release Published  │
│ Download artifacts │
│ Deploy with        │
│ talosctl           │
│ You're done        │
└────────────────────┘

## Registry Push Flow

                Build Pipeline
                      ↓
        ┌─────────────┼─────────────┐
        ↓             ↓             ↓
   BRANDING      SECURITY      INSTALLER
   Extension     Extension     Image
        ↓             ↓             ↓
        └─────────────┼─────────────┘
                      ↓
            ghcr.io/itlusions/
            ├─ itl-talos-branding:v1.0.0
            ├─ itl-talos-security:v1.0.0
            └─ itl-talos-installer:v1.0.0

These are referenced in:
  controlplane-final.yaml
  worker-final.yaml

## One-Minute Summary

1. Create Tag
   git tag v1.0.0
   git push origin v1.0.0

2. Pipeline Runs (Watch Actions tab)

3. Download (From Releases tab)
   - ISO image
   - YAML configs

4. Deploy
   talosctl apply-config --nodes <ip> --file controlplane-final.yaml

5. Done

---

See 01-QUICK_REFERENCE.md for commands or 03-SIMPLIFIED_SETUP.md for walkthrough.
